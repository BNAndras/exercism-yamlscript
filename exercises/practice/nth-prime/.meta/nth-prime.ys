!yamlscript/v0

defn prime(number):
  lazy-primes().nth(number - 1)

defn- lazy-primes(d=2 table={}):
  if-let factors table.$d:
    recur inc(d):
      reduce _ table.dissoc(d) factors:
        \(update-in(%1 [(%2 + d)] conj %2))
    lazy-seq:
      cons d:
        lazy-primes inc(d):
          table: .assoc(sqr(d) [d])
