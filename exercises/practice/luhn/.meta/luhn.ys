!yamlscript/v0

defn valid(value):
  digits =: value.replace(' ' '')

  and:
    ge: len(digits) 2
    not: digits =~ /[^0-9]/
    f?:
      rem _ 10:
        digits:
          .split().remove(empty?).map(num)
          .reverse().vec().conj(0).partition(2)
          .map(munge).flatten().sum(*)

defn munge([a b]):
  b =: 2 * b
  b =:
    if b > 9: (b - 9) b
  vector: a b
